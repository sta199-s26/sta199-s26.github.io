---
title: "AE 05: Gerrymandering + data exploration II"
subtitle: "Suggested answers"
categories: 
  - Application exercise
  - Answers
---

## Getting started

### Packages

We'll use the **tidyverse** package for this analysis.

```{r}
#| label: load-packages
#| message: false
#| warning: false
library(tidyverse)
library(usdata)
library(ggbeeswarm)
library(ggthemes)
library(scales)
```

### Data

The data are availale in the **usdata** package.

```{r}
#| label: gerrymander
glimpse(gerrymander)
```

## Congressional districts per state

Which state has the most congressional districts?
How many congressional districts are there in this state?

```{r}
#| label: districts
gerrymander |>
  count(state, sort = TRUE)
```

California has the most, with `{r} gerrymander |> count(state, sort = TRUE) |> filter(state == "CA") |> pull(n)` congressional districts.

## Gerrymandering and flipping

Is a Congressional District more likely to be flipped to a Democratic seat if it has high prevalence of gerrymandering or low prevalence of gerrymandering?
Support your answer with a visualization and summary statistics.

```{r}
#| label: flips
#| fig-asp: 0.4
gerrymander |>
  mutate(flip18 = as_factor(flip18)) |>
  ggplot(aes(y = gerry, fill = flip18)) +
  geom_bar(position = "fill")

gerrymander |>
  count(gerry, dem18) |>
  group_by(gerry) |>
  mutate(p = n / sum(n))
```

If a district is highly gerrymandered, it's less likely to flip in general, no matter what the party is. As gerrymandering goes down (high → mid → low), both parties get more of a shot. 2018 was the first midterm election after the Republicans claimed the White House and Congress in 2016. Historically, such midterms favor the opposition party, so Democrats did more flipping across the board here. But the trend is that you get more flipping of all kinds in less gerrymandered districts.

## Aesthetic mappings

Recreate the following visualization, and then improve it.

![](images/gerrymander-recreate.png)

### Recreate

```{r}
#| label: recreate
#| fig-asp: 0.4
ggplot(gerrymander, aes(x = gerry, y = clinton16, color = gerry)) +
  geom_beeswarm(color = "gray50", alpha = 0.5) +
  geom_boxplot(alpha = 0.5) +
  theme_minimal()
```

### Improve

```{r}
#| label: improve
#| fig-asp: 0.4
ggplot(gerrymander, aes(x = gerry, y = clinton16)) +
  geom_beeswarm(color = "gray50", alpha = 0.5) +
  geom_boxplot(
    aes(color = gerry),
    alpha = 0.5,
    show.legend = FALSE
  ) +
  scale_color_colorblind() +
  scale_y_continuous(labels = label_percent(scale = 1)) +
  theme_minimal() +
  labs(
    x = "Gerrymandering prevalence",
    y = "Clinton vote share, 2016 (%)",
  )
```